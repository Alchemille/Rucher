{% extends "base.html"%}
{% block content %}
<div class="jumbotron">


    <div class="card-columns">
        {% for i in ruchers %}
        <div class="card border-info mb-3 ">

            <div class="center-cropped card-img-top" style="background-image: url('{{ i.get_url_image() }}'); height: 200px;">
                <a href="{{ url_for('see_rucher', id=i.id) }}">
                <img src="{{ i.get_url_image() }}" />                    
                </a>
                
            </div>

            <div class="card-body d-flex" >
                <p class="card_text_rucher card-text">{{ i }}</p>
                <form action="{{ url_for('delete_rucher', id=i.id) }}" method="post" class="ml-auto">
                    <button class="btn btn-dark" type="submit">
                        <svg class="bi bi-trash-fill" width="20" height="20" viewBox="0 0 16 16" fill="currentColor"
                            xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd"
                                d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z" />
                        </svg>
                    </button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>


<div>
    <a class="btn btn-primary" href="{{url_for('add_rucher')}}">Ajouter un rucher</a>
</div>

</div>

<hr/>

<div class="jumbotron_feli jumbotron">
<div class="d-flex justify-content-center align-items-center">
    <div id='map' style='width: 700px; height: 500px;'></div>
    <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoianNvbWEiLCJhIjoibFJmYl9JWSJ9.AUm8d76cbOvVEn2mMeG_ZA';
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v10',
      center: [0.529145, 45.440493],
      zoom: 10      
    });
    map.on('load', function() {
      var geojsonData = {
        "type": "FeatureCollection",
        "features": [{
          "type": "Feature",
          "geometry": {
            "type": "Point",
            "coordinates": [0.529145, 45.440493]
          }
        }]
      };
      {% for i in ruchers %}
      var new_rucher = {
          "type": "Feature",
          "geometry": {
            "type": "Point",
            "coordinates": ["{{ i.lat }}", "{{ i.longit }}"]
          }
        }
      geojsonData.features.push(new_rucher)
      {% endfor %}

      map.addLayer({
        "id": "points",
        "type": "circle",
        "source": {
          "type": "geojson",
          "data": geojsonData
        }
      })
    })
    </script>
    <p></p>
</div>
</div>


{% endblock %}